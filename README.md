# PI_Luca_Killian



## What is it about ?

This multiphysics integrated computational project is focused on computational fluid dynamics in continuum mechanic and more precisely focused on the **Smoothed-particle hydrodynamics** (so-called SPH method) which is computed in c++ language. This method has been created in the 19's (1977 by Gingold, Monaghan and Lucy) and is thus relatively new. Hence, one specificaly focuses on microfluidic applications (such as surface tensions, adhesions) in order to compare our results to some well known examples to assess the accuracy of our models.

## How to run the code ?

### Before launching simulation
Once all files are downloaded, few things have to be considered before running simulations. Indeed, this c++ code is compiled using CMake (to ease the use of makefiles) and Ninja (to ease the access to files/folders' name) and thus some variables have to be defined beforehand.

Windows : In the upper path of the folder **PI_LUCA_KILLIAN** write in a terminal
    ```envs\windows.cmd```

which will first set the location of mingw compiler/zlib/cmake; create mandatory local environment variables and immediatly shift your path to the desired location (in the build folder).

<u>Note</u> : to run this code correctly, you need to download the main folder in this precise path:

```C:\Users\Username\pi_luca_killian\src\build>```

### Define simulation
In the **.json** file, several parameters can be adjusted:
    - thermodynamics variables (temperature, density, R, heat capacity ratio, ...)
    - particles (either fluid particles or fixed particles)
    - state equation between pressure and density (ideal gaz law or quasi incompressible fluid)
    - initial density (either same density for all fluid particles either density respecing hydrostatic law)

The particles can be generated by the use of "parallelipepidic bunch of particles" (rectangle full of particles) where the width, heigh and lengh of the rectangle can be modified (it can become a simple wall with a unitary thickness).

Here is an example of .json file used:

```json
s = 0.025
L = 1.2
dimension = 2

nb_vtp_output = 250 # the total number of output file desired
dt = 0.0001
nstepT = 25000
nsave = nb_vtp_output/(dt*nstepT)  

data = {
    
    "simulation": {
        "theta": 0.5,
        "s": s,
        "nstepT": nstepT,
        "dt": dt,
        "nsave": nsave,
        "kappa": 2,
        "alpha": 0.5,
        "beta": 0,
        "alpha_st": 10,
        "beta_adh": 1.2,
        "dimension": dimension
    },
    
    "domain": {
        "matrix_long": [
            [0.3*L, s/2, 0.3*L], # fluid
            [L, s/2, s/2], # floor 1
            [L, s/2, s/2], # floor 2
            [s/2, s/2, L], # left wall 1
            [s/2, s/2, L], # left wall 2
            [s/2, s/2, L], # right wall 1
            [s/2, s/2, L-s/2], # right wall 2

        ],
        "matrix_orig": [
            [0.35*L, 0, L], # fluid
            [0, 0, 0], # floor 1
            [s/2, 0, s/2], # floor 2
            [s/2, 0, 3*s/2],# left wall 1
            [0, 0, s], # left wall 2
            [L, 0, s], # right wall 1
            [L+s/2, 0, 1.5*s], # right wall 2

        ],
        "vector_type": [1, 0, 0, 0, 0, 0, 0],
        "L_d": [2*L, 2*L, 2*L],
        "o_d": [0.0, 0.0, 0.0]
    },
    "post_process": {
        "do": False,
        "xyz_init": [L/2, 0, s],
        "xyz_end": [L/2, 0, L-2*s]
    },
    "thermo": {
        "rho_0": 1000,
        "rho_moving": 1000,
        "rho_fixed": 1000,
        "T": 298.15,
        "u_init": [0.0, 0.0, 0.0],
        "c_0": 30,
        "gamma": 7,
        "M": 18e-3,
        "R": 8.314,
        "sigma": 52000
    },
    "forces": {
        "gravity": True,
        "surface_tension": False,
        "adhesion": False
    },
    "condition": {
        "print_debug": False,
        "schemeIntegration": {"Euler": True, "RK22": False},
        "stateEquation": {"Ideal gaz law": False, "Quasi incompresible fluid": True},
        "initialCondition": {"Hydrostatic": False, "Constant": True}
    }
}

```
### Launch simulation

Once everything is ready, one can run the code by the following code line:
    ```solver.exe ../../json/splash/2D_splash.json```

In the example above, a cube of fluid particles will experience a splash. An example of 3D simulation is presented below:

![Test GIF](splash.gif)

### Analyse simulation

The results of the particles variables (position, velocity, pressure, density, speed of sound, number of neighbours, ...) can be visuallized using either Paraview (for nice spatial view) or our python scripts (which are simply reading **.csv** files created during the simulation).

One focused on the density and pressure of particles. The ghost particles are created given a lign (whose coodinates are indicated in the json file) and the associated variable will be evaluated using the **summation method** (explain in the final report).

To plot the variables, you will find in the file **Misc_python/Analysis.py** many script allowing the user to plot density and pressure in many ways. Either by plotting one variable with respect to the other, or plotting the pressure/density along the spatial line on which lye ghost particles.



